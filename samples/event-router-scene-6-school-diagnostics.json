{
  "scene": {
    "id": "event-router-scene-6-school",
    "canvas": {
      "width": 800,
      "height": 400
    },
    "bg": "#87CEEB",
    "defs": {
      "filters": [
        "<filter id=\"sceneShadow\" x=\"-20%\" y=\"-20%\" width=\"140%\" height=\"140%\"><feDropShadow dx=\"0\" dy=\"4\" stdDeviation=\"8\" flood-color=\"#000\" flood-opacity=\"0.25\"/></filter>",
        "<filter id=\"schoolGlow\"><feGaussianBlur stdDeviation=\"2\" result=\"b\"/><feMerge><feMergeNode in=\"b\"/><feMergeNode in=\"SourceGraphic\"/></feMerge></filter>",
        "<filter id=\"celebrationGlow\"><feGaussianBlur stdDeviation=\"4\" result=\"b\"/><feMerge><feMergeNode in=\"b\"/><feMergeNode in=\"SourceGraphic\"/></feMerge></filter>"
      ],
      "gradients": [
        "<linearGradient id=\"roadGradient\" x1=\"0\" y1=\"0\" x2=\"1\" y2=\"0\"><stop offset=\"0\" stop-color=\"#404040\"/><stop offset=\"0.5\" stop-color=\"#505050\"/><stop offset=\"1\" stop-color=\"#404040\"/></linearGradient>",
        "<linearGradient id=\"schoolGradient\" x1=\"0\" y1=\"0\" x2=\"1\" y2=\"1\"><stop offset=\"0\" stop-color=\"#CD853F\"/><stop offset=\"1\" stop-color=\"#8B4513\"/></linearGradient>",
        "<linearGradient id=\"roofGradient\" x1=\"0\" y1=\"0\" x2=\"1\" y2=\"1\"><stop offset=\"0\" stop-color=\"#8B0000\"/><stop offset=\"1\" stop-color=\"#654321\"/></linearGradient>",
        "<linearGradient id=\"courtyardGradient\" x1=\"0\" y1=\"0\" x2=\"1\" y2=\"0\"><stop offset=\"0\" stop-color=\"#C0C0C0\"/><stop offset=\"1\" stop-color=\"#A0A0A0\"/></linearGradient>"
      ]
    },
    "nodes": [
      {
        "kind": "boundary",
        "id": "scene-6-boundary",
        "title": "Scene 6: Final Destination (Application State Updated)",
        "at": {
          "x": 20,
          "y": 20
        },
        "size": {
          "width": 760,
          "height": 360
        },
        "style": {
          "fill": "#E8F5E8",
          "stroke": "#4CAF50",
          "strokeWidth": 2,
          "labelColor": "#4CAF50",
          "filter": "url(#sceneShadow)"
        },
        "grid": {
          "cols": 4,
          "rowH": 80,
          "gutter": 20,
          "padding": 20
        },
        "policy": {
          "mode": "strict",
          "overflow": "clip",
          "tolerance": 2,
          "snap": {
            "grid": 4
          }
        },
        "children": [
          {
            "kind": "shape",
            "id": "sky-background",
            "at": {
              "x": 0,
              "y": 0
            },
            "size": {
              "width": 760,
              "height": 200
            },
            "shape": "rect",
            "style": {
              "fill": "#87CEEB",
              "stroke": "none"
            },
            "_absRect": {
              "x": 20,
              "y": 20,
              "w": 760,
              "h": 200
            }
          },
          {
            "kind": "shape",
            "id": "ground",
            "at": {
              "x": 0,
              "y": 200
            },
            "size": {
              "width": 760,
              "height": 120
            },
            "shape": "rect",
            "style": {
              "fill": "#4A6B3A",
              "stroke": "none"
            },
            "_absRect": {
              "x": 20,
              "y": 220,
              "w": 760,
              "h": 120
            }
          },
          {
            "kind": "shape",
            "id": "road-ending",
            "at": {
              "x": 0,
              "y": 230
            },
            "size": {
              "width": 400,
              "height": 60
            },
            "shape": "rect",
            "style": {
              "fill": "url(#roadGradient)",
              "stroke": "#606060",
              "strokeWidth": 2
            },
            "_absRect": {
              "x": 20,
              "y": 252,
              "w": 400,
              "h": 60
            }
          },
          {
            "kind": "shape",
            "id": "school-courtyard",
            "at": {
              "x": 400,
              "y": 230
            },
            "size": {
              "width": 360,
              "height": 60
            },
            "shape": "rect",
            "style": {
              "fill": "url(#courtyardGradient)",
              "stroke": "#606060",
              "strokeWidth": 2
            },
            "_absRect": {
              "x": 420,
              "y": 252,
              "w": 360,
              "h": 60
            }
          },
          {
            "kind": "shape",
            "id": "school-building",
            "at": {
              "x": 500,
              "y": 50
            },
            "size": {
              "width": 200,
              "height": 120
            },
            "shape": "rect",
            "style": {
              "fill": "url(#schoolGradient)",
              "stroke": "#8B4513",
              "strokeWidth": 2,
              "filter": "url(#schoolGlow)"
            },
            "_absRect": {
              "x": 520,
              "y": 72,
              "w": 200,
              "h": 120
            }
          },
          {
            "kind": "shape",
            "id": "school-roof",
            "at": {
              "x": 490,
              "y": 50
            },
            "size": {
              "width": 220,
              "height": 40
            },
            "shape": "polygon",
            "style": {
              "fill": "url(#roofGradient)",
              "stroke": "#654321",
              "strokeWidth": 2
            },
            "_absRect": {
              "x": 512,
              "y": 72,
              "w": 220,
              "h": 40
            }
          },
          {
            "kind": "shape",
            "id": "school-entrance",
            "at": {
              "x": 585,
              "y": 120
            },
            "size": {
              "width": 30,
              "height": 50
            },
            "shape": "roundedRect",
            "style": {
              "fill": "#4682B4",
              "stroke": "#2F4F4F",
              "strokeWidth": 2
            },
            "_absRect": {
              "x": 604,
              "y": 140,
              "w": 30,
              "h": 50
            }
          },
          {
            "kind": "shape",
            "id": "entrance-window",
            "at": {
              "x": 587,
              "y": 122
            },
            "size": {
              "width": 26,
              "height": 25
            },
            "shape": "roundedRect",
            "style": {
              "fill": "#87CEEB",
              "stroke": "#4682B4",
              "strokeWidth": 1
            },
            "_absRect": {
              "x": 608,
              "y": 144,
              "w": 26,
              "h": 25
            }
          },
          {
            "kind": "shape",
            "id": "school-window-1",
            "at": {
              "x": 520,
              "y": 70
            },
            "size": {
              "width": 20,
              "height": 20
            },
            "shape": "rect",
            "style": {
              "fill": "#87CEEB",
              "stroke": "#4682B4",
              "strokeWidth": 1
            },
            "_absRect": {
              "x": 540,
              "y": 92,
              "w": 20,
              "h": 20
            }
          },
          {
            "kind": "shape",
            "id": "school-window-2",
            "at": {
              "x": 550,
              "y": 70
            },
            "size": {
              "width": 20,
              "height": 20
            },
            "shape": "rect",
            "style": {
              "fill": "#87CEEB",
              "stroke": "#4682B4",
              "strokeWidth": 1
            },
            "_absRect": {
              "x": 572,
              "y": 92,
              "w": 20,
              "h": 20
            }
          },
          {
            "kind": "shape",
            "id": "school-window-3",
            "at": {
              "x": 630,
              "y": 70
            },
            "size": {
              "width": 20,
              "height": 20
            },
            "shape": "rect",
            "style": {
              "fill": "#87CEEB",
              "stroke": "#4682B4",
              "strokeWidth": 1
            },
            "_absRect": {
              "x": 652,
              "y": 92,
              "w": 20,
              "h": 20
            }
          },
          {
            "kind": "shape",
            "id": "school-window-4",
            "at": {
              "x": 660,
              "y": 70
            },
            "size": {
              "width": 20,
              "height": 20
            },
            "shape": "rect",
            "style": {
              "fill": "#87CEEB",
              "stroke": "#4682B4",
              "strokeWidth": 1
            },
            "_absRect": {
              "x": 680,
              "y": 92,
              "w": 20,
              "h": 20
            }
          },
          {
            "kind": "shape",
            "id": "flagpole",
            "at": {
              "x": 598,
              "y": 0
            },
            "size": {
              "width": 4,
              "height": 60
            },
            "shape": "rect",
            "style": {
              "fill": "#8B4513",
              "stroke": "none"
            },
            "_absRect": {
              "x": 620,
              "y": 20,
              "w": 4,
              "h": 60
            }
          },
          {
            "kind": "shape",
            "id": "flag",
            "at": {
              "x": 602,
              "y": 5
            },
            "size": {
              "width": 30,
              "height": 20
            },
            "shape": "rect",
            "style": {
              "fill": "#FF0000",
              "stroke": "none"
            },
            "_absRect": {
              "x": 624,
              "y": 24,
              "w": 30,
              "h": 20
            }
          },
          {
            "kind": "text",
            "id": "school-sign",
            "at": {
              "x": 600,
              "y": 180
            },
            "text": "ELEMENTARY SCHOOL",
            "style": {
              "fill": "#333333",
              "fontSize": 10,
              "fontWeight": "bold",
              "textAnchor": "middle"
            },
            "_absRect": {
              "x": 620,
              "y": 200,
              "w": 136,
              "h": 16
            }
          },
          {
            "kind": "shape",
            "id": "school-bus",
            "at": {
              "x": 250,
              "y": 200
            },
            "size": {
              "width": 120,
              "height": 40
            },
            "shape": "roundedRect",
            "style": {
              "fill": "#FFD700",
              "stroke": "#E6C200",
              "strokeWidth": 2
            },
            "_absRect": {
              "x": 272,
              "y": 220,
              "w": 120,
              "h": 40
            }
          },
          {
            "kind": "text",
            "id": "bus-label",
            "at": {
              "x": 310,
              "y": 215
            },
            "text": "SCHOOL BUS",
            "style": {
              "fill": "#000000",
              "fontSize": 8,
              "fontWeight": "bold",
              "textAnchor": "middle"
            },
            "_absRect": {
              "x": 332,
              "y": 236,
              "w": 80,
              "h": 16
            }
          },
          {
            "kind": "shape",
            "id": "child-1",
            "at": {
              "x": 380,
              "y": 270
            },
            "size": {
              "width": 8,
              "height": 16
            },
            "shape": "roundedRect",
            "style": {
              "fill": "#3B82F6",
              "stroke": "#1E3A8A",
              "strokeWidth": 1
            },
            "_absRect": {
              "x": 400,
              "y": 292,
              "w": 8,
              "h": 16
            }
          },
          {
            "kind": "shape",
            "id": "child-2",
            "at": {
              "x": 420,
              "y": 275
            },
            "size": {
              "width": 8,
              "height": 16
            },
            "shape": "roundedRect",
            "style": {
              "fill": "#10B981",
              "stroke": "#059669",
              "strokeWidth": 1
            },
            "_absRect": {
              "x": 440,
              "y": 296,
              "w": 8,
              "h": 16
            }
          },
          {
            "kind": "shape",
            "id": "child-3",
            "at": {
              "x": 480,
              "y": 280
            },
            "size": {
              "width": 8,
              "height": 16
            },
            "shape": "roundedRect",
            "style": {
              "fill": "#EF4444",
              "stroke": "#DC2626",
              "strokeWidth": 1
            },
            "_absRect": {
              "x": 500,
              "y": 300,
              "w": 8,
              "h": 16
            }
          },
          {
            "kind": "shape",
            "id": "child-4",
            "at": {
              "x": 580,
              "y": 285
            },
            "size": {
              "width": 8,
              "height": 16
            },
            "shape": "roundedRect",
            "style": {
              "fill": "#FBBF24",
              "stroke": "#F59E0B",
              "strokeWidth": 1
            },
            "_absRect": {
              "x": 600,
              "y": 304,
              "w": 8,
              "h": 16
            }
          },
          {
            "kind": "shape",
            "id": "celebration-balloon-1",
            "at": {
              "x": 720,
              "y": 150
            },
            "size": {
              "width": 8,
              "height": 8
            },
            "shape": "circle",
            "style": {
              "fill": "#FF6B6B",
              "stroke": "none",
              "filter": "url(#celebrationGlow)"
            },
            "_absRect": {
              "x": 740,
              "y": 172,
              "w": 8,
              "h": 8
            }
          },
          {
            "kind": "shape",
            "id": "celebration-balloon-2",
            "at": {
              "x": 712,
              "y": 158
            },
            "size": {
              "width": 6,
              "height": 6
            },
            "shape": "circle",
            "style": {
              "fill": "#4ECDC4",
              "stroke": "none",
              "filter": "url(#celebrationGlow)"
            },
            "_absRect": {
              "x": 732,
              "y": 180,
              "w": 6,
              "h": 6
            }
          },
          {
            "kind": "shape",
            "id": "celebration-balloon-3",
            "at": {
              "x": 728,
              "y": 158
            },
            "size": {
              "width": 6,
              "height": 6
            },
            "shape": "circle",
            "style": {
              "fill": "#45B7D1",
              "stroke": "none",
              "filter": "url(#celebrationGlow)"
            },
            "_absRect": {
              "x": 748,
              "y": 180,
              "w": 6,
              "h": 6
            }
          },
          {
            "kind": "text",
            "id": "sky-headline",
            "at": {
              "x": 380,
              "y": 40
            },
            "text": "Destination reached.",
            "style": {
              "fill": "#1E3A56",
              "fontSize": 24,
              "fontWeight": "bold",
              "textAnchor": "middle",
              "stroke": "#FFFFFF",
              "strokeWidth": 1
            },
            "_absRect": {
              "x": 400,
              "y": 60,
              "w": 160,
              "h": 16
            }
          },
          {
            "kind": "text",
            "id": "sky-description",
            "at": {
              "x": 380,
              "y": 65
            },
            "text": "Events arrive at the school â€” the application state is updated.",
            "style": {
              "fill": "#3C556E",
              "fontSize": 16,
              "textAnchor": "middle"
            },
            "_absRect": {
              "x": 276,
              "y": 84,
              "w": 504,
              "h": 16
            }
          },
          {
            "kind": "text",
            "id": "scene-caption",
            "at": {
              "x": 380,
              "y": 320
            },
            "text": "Destination reached: application state updated (successful delivery)",
            "style": {
              "fill": "#4CAF50",
              "fontSize": 14,
              "fontWeight": "bold",
              "textAnchor": "middle"
            },
            "_absRect": {
              "x": 236,
              "y": 340,
              "w": 544,
              "h": 16
            }
          }
        ],
        "_absRect": {
          "x": 20,
          "y": 20,
          "w": 760,
          "h": 360
        }
      }
    ],
    "ports": [
      {
        "id": "school-in",
        "nodeId": "scene-6-boundary",
        "side": "left",
        "offset": 180
      }
    ],
    "flows": [
      {
        "id": "final-delivery-flow",
        "path": "school-in",
        "token": {
          "size": 6,
          "color": "#4CAF50",
          "trail": {
            "length": 100,
            "opacity": 0.4
          }
        },
        "speed": 60,
        "loop": true,
        "activate": {
          "boundaryIds": [
            "scene-6-boundary"
          ],
          "className": "active-scene"
        }
      }
    ]
  },
  "diagnostics": [
    {
      "code": "OUT_OF_BOUNDS",
      "nodeId": "sky-description",
      "boundaryId": "scene-6-boundary",
      "severity": "error",
      "message": "Node 'sky-description' escapes boundary 'scene-6-boundary'.",
      "actual": {
        "rect": {
          "x": 400,
          "y": 84,
          "w": 504,
          "h": 16
        },
        "boundary": {
          "x": 20,
          "y": 20,
          "w": 760,
          "h": 360
        }
      },
      "suggestedFix": {
        "at": {
          "x": 276,
          "y": 84
        }
      }
    },
    {
      "code": "OUT_OF_BOUNDS",
      "nodeId": "scene-caption",
      "boundaryId": "scene-6-boundary",
      "severity": "error",
      "message": "Node 'scene-caption' escapes boundary 'scene-6-boundary'.",
      "actual": {
        "rect": {
          "x": 400,
          "y": 340,
          "w": 544,
          "h": 16
        },
        "boundary": {
          "x": 20,
          "y": 20,
          "w": 760,
          "h": 360
        }
      },
      "suggestedFix": {
        "at": {
          "x": 236,
          "y": 340
        }
      }
    }
  ],
  "summary": {
    "errors": 2,
    "warnings": 0
  }
}